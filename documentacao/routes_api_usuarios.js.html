<h2>src/routes/api/usuarios.js</h2>

<pre><code class="lang-js">const Router = require('express').Router();

const { validarUsuario, validarSenha } = require('../../middleware/validacao');
const controller = require('../../controller/usuarios');

Router.post('/logout', controller.logout);

Router.use(validarUsuario);

Router.post('/', validarSenha, controller.cadastro);

Router.post('/login', controller.login);

module.exports = Router;
</code></pre>

<h3>Visão Geral</h3>

<p>
    Este módulo tem a responsabilidade de definir quais devem ser os endpoints
    de nossa API que ficarão responsável pela entidade usuarios. A partir deste
    módulo o cliente poderá cadastrar um usuário, realizar login e logout.
</p>

<h3>Comentários</h3>
<ul>
    <li>
        <span class="lf-strong">Linha 1</span>: Criamos o objeto Router que irá
        definer os eventos para cada endpoint.
        <pre><code class="lang-js">const Router = require('express').Router();
            </code></pre>
    </li>
    <li>
        <span class="lf-strong">Linhas 3 e 4</span>: Importamos as funções
        middleware de validação de dados de usuário e senha e o objeto
        controller que irá fornecer respostas adequadas aos endpoints da API.
        <pre><code class="lang-js">const { validarUsuario, validarSenha } = require('../../middleware/validacao');
const controller = require('../../controller/usuarios');</code></pre>
    </li>
    <li>
        <span class="lf-strong">Linha 6</span>: Definimos que o endpoint
        /api/usuarios/logout, quando recebe uma requisição do verbo POST,
        executa o método controller.logout(), este irá realizar a rotina para
        desautenticar o token do usuário que enviou a requisição.
        <pre><code class="lang-js">Router.post('/logout', controller.logout);
            </code></pre>
    </li>
    <li>
        <span class="lf-strong">Linha 8</span>: Acrescenta o middleware
        validarUsuario ao ciclo requisição-resposta da rota, este middleware
        será responsável por certificar que os dados informados pelo cliente no
        corpo da requisição são válidos para os próximos endpoints.
        <pre><code class="lang-js">Router.use(validarUsuario);
            </code></pre>
    </li>
    <li>
        <span class="lf-strong">Linha 10</span>: É definido que o endpoint
        /api/usuarios/, quando receber uma requisição do verbo POST, irá
        executar a função de middleware validarSenha para garantir que o formato
        da senha seja adequado, caso seja irá executar o método
        controller.cadastro para cadastrar o usuário no banco de dados e
        retornar um token autenticado.
        <pre><code class="lang-js">Router.post('/', validarSenha, controller.cadastro);
            </code></pre>
    </li>
    <li>
        <span class="lf-strong">Linha 12</span>: Define que o endpoint
        /api/usuarios/login, quando receber uma requisição do verbo POST, irá
        executar o método controller.login()que irá verificar as credenciais
        fornecidas no corpo da requisição e, caso sejam válidas, responder com
        um token autenticado.
        <pre><code class="lang-js">Router.post('/login', controller.login);
            </code></pre>
    </li>
    <li>
        <span class="lf-strong">Linha 14</span>: Exportamos o objeto Router para
        que o módulo de rotas possa ser usado pela aplicação.

        <pre><code class="lang-js">module.exports = Router;
            </code></pre>
    </li>
</ul>
